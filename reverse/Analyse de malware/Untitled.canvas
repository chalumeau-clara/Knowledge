{
	"nodes":[
		{"id":"cf28d5a93cc428b3","type":"text","text":"check \\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security","x":-380,"y":-340,"width":720,"height":80},
		{"id":"c96708b0a8484ac2","type":"text","text":"Decode_string() fonction called","x":-241,"y":-181,"width":443,"height":60},
		{"id":"2e755627c14827ce","type":"text","text":"Load kernell32, advapi32 and ndtdll library","x":-360,"y":-53,"width":680,"height":60},
		{"id":"c36fa3b7aa828615","type":"text","text":"Check with GetLocaleInfoA() if it is a korean computer","x":-340,"y":69,"width":640,"height":60},
		{"id":"bfbb754a212203ff","type":"text","text":"yes exit","x":-391,"y":219,"width":250,"height":60},
		{"id":"107a0f34433eebbe","type":"text","text":"No continue","x":92,"y":224,"width":250,"height":60},
		{"id":"a9ec581b64f8a140","type":"text","text":"Get OS version with GetVersionExA()","x":34,"y":360,"width":366,"height":60},
		{"id":"96423f4e02787a77","type":"text","text":"if 6.2 or 5.2/1","x":225,"y":516,"width":250,"height":60},
		{"id":"fb8ed2a8967bab02","type":"text","text":"get handle for ntdll","x":225,"y":622,"width":250,"height":60},
		{"id":"6fd62fd513d2c00a","type":"text","text":"exit fonction","x":-91,"y":516,"width":250,"height":60},
		{"id":"b023b47687e97dcf","type":"text","text":"ZwQuerySystemInformation get proc addr","x":191,"y":740,"width":319,"height":60},
		{"id":"404cf5289a3d8556","type":"text","text":"Retrieves the path of the system directory _kernel32_GetSystemDirectoryA()","x":273,"y":880,"width":475,"height":83},
		{"id":"97793d8348bd04b9","type":"text","text":"sub_4013A0","x":395,"y":1042,"width":250,"height":60},
		{"id":"6c5577eb8d84f1de","type":"text","text":"Check \\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security","x":273,"y":1180,"width":747,"height":60},
		{"id":"5d5a8d8ad3ef4a10","type":"text","text":"C:\\Windows\\system32","x":522,"y":1324,"width":250,"height":60},
		{"id":"91a4fa06161d7a95","type":"text","text":"NtOpenKey on \\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security","x":320,"y":1478,"width":660,"height":60},
		{"id":"592500b25335ee70","type":"text","text":"NtQueryValueKey with 125463f3-2a9c-bdf0-d890-5a98b08d8898\ncmp 0C0000023h ","x":340,"y":1647,"width":620,"height":60},
		{"id":"79352d45a66242c3","type":"text","text":"yes ","x":720,"y":1832,"width":250,"height":60},
		{"id":"0c72fa02cb731085","type":"text","text":"NO\nCmp 80000005h (E fail)","x":340,"y":1832,"width":292,"height":60},
		{"id":"02eb41f92405846d","type":"text","text":"jnz yes exit ntdll close","x":170,"y":2008,"width":250,"height":60},
		{"id":"90495442477be4b1","type":"text","text":"same for f0012345-2a9c-bdf8-345d-345d67b542a1","x":505,"y":2020,"width":430,"height":60},
		{"id":"822186f95c651cfc","type":"text","text":"open service ?","x":669,"y":2219,"width":250,"height":60},
		{"id":"85cbf008ea9ab498","type":"text","text":"return end","x":664,"y":2355,"width":250,"height":60},
		{"id":"b3006f4432562c3f","type":"text","text":" choose randomly two of these : \n \n ![[Pasted image 20231210171845.png]]\n\nthen choose randomly one of these : \n![[Pasted image 20231210174905.png]]\n\nConstruit \n\nIf the service is stopped or disabled, Windows will be able to damaged seriously.\n\nis an essential service for management of Windows System.\n\nCreate a random dll file name within strings put his path to C:\\\\Windows\\\\system32\\\\Fotienum.dll\n\n\n\n","x":-340,"y":2233,"width":606,"height":867},
		{"id":"bf55eaf344045138","type":"text","text":"Find resource lpname : f\n\nload rsc start with PK (eff3e37d0406c818e3430068d90e7ed2f594faa6bb146ab0a1c00a2f4a4809a5:00415064)\nLockResource\nsizeof \n\n\nFuncInfoV1 struc ; (sizeof=0x1C, mappedto_29)\n00000000                                         ; XREF: .rdata:stru_40FD80/r\n00000000 magicNumber dd ?                        ; base 16\n00000004 maxState dd ?                           ; base 10\n00000008 pUnwindMap dd ?                         ; offset\n0000000C nTryBlocks dd ?                         ; base 10\n00000010 pTryBlockMap dd ?                       ; offset\n00000014 nIPMapEntries dd ?                      ; base 10\n00000018 pIPtoStateMap dd ?                      ; offset\n0000001C FuncInfoV1 ends\n\n","x":-638,"y":3340,"width":1203,"height":500},
		{"id":"db038b89a9525ab7","type":"text","text":"GetCurrentDirectoryA = > C:\\Users\\clara\\Documents\\malware\\Lazarus\n","x":-580,"y":4029,"width":1100,"height":71},
		{"id":"302fbe985ba7d612","type":"text","text":"try de get the right offset?","x":-156,"y":4246,"width":250,"height":60},
		{"id":"1fbd91b49cf38b72","type":"text","text":"set fileTime ??","x":-156,"y":4429,"width":250,"height":60},
		{"id":"d0cd54f97db61934","type":"text","text":"get embedded ressoucees and the right offset ?","x":-156,"y":4565,"width":250,"height":60},
		{"id":"8b5abd189396ee17","type":"text","text":"Create file C:\\\\Windows\\\\system32\\\\fotienum.dll (4020a0\nwrite file with rsc start with MZ","x":-155,"y":4783,"width":515,"height":77},
		{"id":"0a18f19078599293","type":"text","text":"FindFirstFileA C:\\Windows\\system32\\notepad.exe","x":-400,"y":5013,"width":625,"height":67},
		{"id":"bd8c1b616a17b38a","type":"text","text":"pq recrer avec kernel32 ?","x":-220,"y":5178,"width":620,"height":62},
		{"id":"658793dce85ba8ad","type":"text","text":"set time of fotinum?dll to the time of notepad","x":-33,"y":5408,"width":633,"height":72},
		{"id":"23e607cb6bca9e1b","type":"text","text":"create C:\\Users\\clara\\Documents\\malware\\Lazarus\\eff3e37d0406c818e3430068d90e7ed2f594faa6bb146ab0a1c00a2f4a4809a5","x":-660,"y":5576,"width":1068,"height":124},
		{"id":"4d5049711949f9bb","type":"text","text":"Registry\\Machine\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security'\n\nset value System\\CurrentControlSet\\Control\\WMI\\Security\\125463f3-2a9c-bdf0-d890-5a98b08d8898 to 51 65 7B 0D 71 FA E7 23 3D 55 77 04 51 61 74 E2\nset key HKLM\\System\\CurrentControlSet\\Control\\WMI\\Security\\f0012345-2a9c-bdf8-345d-345d67b542a1 to 51 65 7B 0D 71 FA E7 23 3D 55 77 04 51 61 74 E2\n\n","x":-252,"y":5789,"width":1292,"height":131},
		{"id":"eb430cb843291b5c","type":"text","text":"Registry\\Machine\\SYSTEM\\CurrentControlSet\\Services\n\nC:\\Users\\cla\\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Services\\fotienum\ncreate key HKLM\\SYSTEM\\CurrentControlSet\\Services\\fotienum with All Access\n\nC:\\Users\\cla\\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Services\\fotienum\\Parameters\n\ncreate key with all access HKLM\\SYSTEM\\CurrentControlSet\\Services\\fotienum\\Parameters\nregset value HKLM\\System\\CurrentControlSet\\Services\\fotienum\\Parameters\\ServiceDll\n\n\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost open key\nset info HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\n\nset value HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\\LocalSystems to fotienum","x":-460,"y":6045,"width":979,"height":375},
		{"id":"8d28bc79f11ce4d0","type":"text","text":"%SystemRoot%\\System32\\svchost.exe -k LocalSystems\n\nadvapi32_CreateServiceA","x":-96,"y":6522,"width":876,"height":138},
		{"id":"8832c17903ba253d","x":666,"y":2508,"width":250,"height":60,"type":"text","text":"delete itself"},
		{"id":"4b3c842ed05fcb0b","x":1200,"y":1677,"width":250,"height":60,"type":"text","text":"C:\\Windows\\system32\\fmudenum.dll"}
	],
	"edges":[
		{"id":"a3a8c5dd7f692c89","fromNode":"cf28d5a93cc428b3","fromSide":"bottom","toNode":"c96708b0a8484ac2","toSide":"top"},
		{"id":"f2670bc95c90a626","fromNode":"c96708b0a8484ac2","fromSide":"bottom","toNode":"2e755627c14827ce","toSide":"top"},
		{"id":"f4b0d20f70b4fc66","fromNode":"2e755627c14827ce","fromSide":"bottom","toNode":"c36fa3b7aa828615","toSide":"top"},
		{"id":"34124fb800b0f3f3","fromNode":"c36fa3b7aa828615","fromSide":"bottom","toNode":"bfbb754a212203ff","toSide":"top"},
		{"id":"719d055ac98da675","fromNode":"c36fa3b7aa828615","fromSide":"bottom","toNode":"107a0f34433eebbe","toSide":"top"},
		{"id":"f1879c2eaff9ce61","fromNode":"107a0f34433eebbe","fromSide":"bottom","toNode":"a9ec581b64f8a140","toSide":"top"},
		{"id":"781797cd6bbd0da9","fromNode":"a9ec581b64f8a140","fromSide":"bottom","toNode":"96423f4e02787a77","toSide":"top"},
		{"id":"eeebad573e8e76ba","fromNode":"96423f4e02787a77","fromSide":"bottom","toNode":"fb8ed2a8967bab02","toSide":"top"},
		{"id":"d509ba0e20d1de89","fromNode":"a9ec581b64f8a140","fromSide":"bottom","toNode":"6fd62fd513d2c00a","toSide":"top"},
		{"id":"046412263ab4b441","fromNode":"fb8ed2a8967bab02","fromSide":"bottom","toNode":"b023b47687e97dcf","toSide":"top"},
		{"id":"f7884c1cac8cb881","fromNode":"b023b47687e97dcf","fromSide":"bottom","toNode":"404cf5289a3d8556","toSide":"top"},
		{"id":"279c9c959926a38b","fromNode":"404cf5289a3d8556","fromSide":"bottom","toNode":"97793d8348bd04b9","toSide":"top"},
		{"id":"39a2527d4df500f0","fromNode":"97793d8348bd04b9","fromSide":"bottom","toNode":"6c5577eb8d84f1de","toSide":"top"},
		{"id":"de075a6282f58f14","fromNode":"6c5577eb8d84f1de","fromSide":"bottom","toNode":"5d5a8d8ad3ef4a10","toSide":"top"},
		{"id":"61690d9fb7dedd25","fromNode":"5d5a8d8ad3ef4a10","fromSide":"bottom","toNode":"91a4fa06161d7a95","toSide":"top"},
		{"id":"d30b743b563158d7","fromNode":"91a4fa06161d7a95","fromSide":"bottom","toNode":"592500b25335ee70","toSide":"top"},
		{"id":"88252336ec0e5f85","fromNode":"592500b25335ee70","fromSide":"bottom","toNode":"79352d45a66242c3","toSide":"top"},
		{"id":"56af1862da95697e","fromNode":"592500b25335ee70","fromSide":"bottom","toNode":"0c72fa02cb731085","toSide":"top"},
		{"id":"79c2b0dac6797fd4","fromNode":"0c72fa02cb731085","fromSide":"bottom","toNode":"02eb41f92405846d","toSide":"top"},
		{"id":"511fd548161f3cb8","fromNode":"79352d45a66242c3","fromSide":"bottom","toNode":"90495442477be4b1","toSide":"top"},
		{"id":"afc5bb7f11025267","fromNode":"0c72fa02cb731085","fromSide":"bottom","toNode":"90495442477be4b1","toSide":"top"},
		{"id":"312f35120e75b3ab","fromNode":"90495442477be4b1","fromSide":"bottom","toNode":"822186f95c651cfc","toSide":"top"},
		{"id":"f2bcb8d436f3e4e8","fromNode":"822186f95c651cfc","fromSide":"bottom","toNode":"85cbf008ea9ab498","toSide":"top"},
		{"id":"4cf0ae7ea881cf2f","fromNode":"02eb41f92405846d","fromSide":"bottom","toNode":"b3006f4432562c3f","toSide":"top"},
		{"id":"ea8cd7fa42a7e294","fromNode":"b3006f4432562c3f","fromSide":"bottom","toNode":"bf55eaf344045138","toSide":"top"},
		{"id":"aad87a4d9dd979a0","fromNode":"bf55eaf344045138","fromSide":"bottom","toNode":"db038b89a9525ab7","toSide":"top"},
		{"id":"fa4844575430db21","fromNode":"db038b89a9525ab7","fromSide":"bottom","toNode":"302fbe985ba7d612","toSide":"top"},
		{"id":"e78708e7ac3424a8","fromNode":"302fbe985ba7d612","fromSide":"bottom","toNode":"1fbd91b49cf38b72","toSide":"top"},
		{"id":"a6b82916d7339d34","fromNode":"1fbd91b49cf38b72","fromSide":"bottom","toNode":"d0cd54f97db61934","toSide":"top"},
		{"id":"adfb50eb1b16cf89","fromNode":"d0cd54f97db61934","fromSide":"bottom","toNode":"8b5abd189396ee17","toSide":"top"},
		{"id":"df6d4b2cada3c343","fromNode":"8b5abd189396ee17","fromSide":"bottom","toNode":"0a18f19078599293","toSide":"top"},
		{"id":"1105cb068ec88c89","fromNode":"0a18f19078599293","fromSide":"bottom","toNode":"bd8c1b616a17b38a","toSide":"top"},
		{"id":"40392d8dea94a674","fromNode":"bd8c1b616a17b38a","fromSide":"bottom","toNode":"658793dce85ba8ad","toSide":"top"},
		{"id":"7a1dafe487eeef79","fromNode":"658793dce85ba8ad","fromSide":"bottom","toNode":"23e607cb6bca9e1b","toSide":"top"},
		{"id":"f2a70db07ce2d5b5","fromNode":"23e607cb6bca9e1b","fromSide":"bottom","toNode":"4d5049711949f9bb","toSide":"top"},
		{"id":"dacc9253ee38475f","fromNode":"4d5049711949f9bb","fromSide":"bottom","toNode":"eb430cb843291b5c","toSide":"top"},
		{"id":"5a6ea5fc321f89a6","fromNode":"eb430cb843291b5c","fromSide":"bottom","toNode":"8d28bc79f11ce4d0","toSide":"top"},
		{"id":"74ce935f167c7a22","fromNode":"85cbf008ea9ab498","fromSide":"bottom","toNode":"8832c17903ba253d","toSide":"top"}
	]
}